<!DOCTYPE html>
<html lang="de">
<head>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="DownAPK">
    <meta name="description" content="Lade deine Lieblinsapps herunter!">
    <meta name="keywords" content="DownAPK, APK, Download, Down, APKMirror, APKPure">
    <meta name="author" content="Nexus">
    
    <meta property="og:title" content="DownAPK - Lade kostenlos APKs herunter!">
    <meta property="og:description" content="Lade deine Apps - kostenlos!">
    <meta property="og:image" content="https://lh3.googleusercontent.com/d/1K8g5EPJgvE0-RbGiyJVGWFaCBc9s27gM">
    <meta property="og:type" content="website">

<link rel="manifest" href="/manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DownAPK</title>

<link rel="icon" type="image/png" href="https://lh3.googleusercontent.com/d/1K8g5EPJgvE0-RbGiyJVGWFaCBc9s27gM">

<link rel="apple-touch-icon" href="https://lh3.googleusercontent.com/d/1K8g5EPJgvE0-RbGiyJVGWFaCBc9s27gM">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* Default Dark Mode */
            --ios-bg: #000000;
            --ios-card: #1C1C1E;
            --ios-blue: #0A84FF;
            --ios-text: #FFFFFF;
            --ios-subtext: #8E8E93;
            --ios-separator: #38383A;
            --glass-border: 1px solid rgba(255, 255, 255, 0.08);
            --nav-bg: rgba(20, 20, 20, 0.5);
            --nav-item: rgba(255,255,255,0.5);
            --nav-active: #FFF;
            
            --radius-l: 32px;
            --radius-m: 18px;
            --header-height: 100px;
            --header-collapsed: 70px;
        }

        /* --- LIGHT MODE VARIABLES --- */
        body.light-mode {
            --ios-bg: #F2F2F7;
            --ios-card: #FFFFFF;
            --ios-blue: #007AFF;
            --ios-text: #000000;
            --ios-subtext: #8E8E93;
            --ios-separator: #C6C6C8;
            --glass-border: 1px solid rgba(0, 0, 0, 0.05);
            --nav-bg: rgba(255, 255, 255, 0.65);
            --nav-item: rgba(0,0,0,0.4);
            --nav-active: #000;
        }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif; 
            margin: 0; background: var(--ios-bg); color: var(--ios-text); 
            padding-bottom: 120px; overflow-x: hidden; -webkit-font-smoothing: antialiased;
            user-select: none; -webkit-user-select: none;
            transition: background 0.3s, color 0.3s;
        }

        a { text-decoration: none !important; color: inherit !important; -webkit-tap-highlight-color: transparent; }

        /* ANIMATIONS */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes scrollText {
            0% { transform: translateX(0); }
            20% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.4; }
            100% { opacity: 1; }
        }
        
        @keyframes popBounce {
            0% { transform: scale(1); }
            40% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        /* NEW IOS MENU ANIMATIONS */
        @keyframes iosMenuSpring {
            0% { opacity: 0; transform: scale(0.8) translateY(10px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .animate-entry {
            opacity: 0; 
            animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }
        
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }

        /* --- HEADER & STICKY LOGIC START --- */
        header { 
            position: fixed; top: 0; left: 0; width: 100%; 
            height: var(--header-height);
            z-index: 1000;
            display: flex; align-items: center; justify-content: flex-start; /* Flex Start behalten */
            padding: 0 20px; box-sizing: border-box;
            transition: height 0.4s cubic-bezier(0.2, 0.8, 0.2, 1), background 0.4s;
            overflow: visible; /* Visible für den Button */
        }

        .header-spacer { height: var(--header-height); width: 100%; }

        .header-blur-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover !important; background-position: center !important;
            filter: blur(25px) brightness(0.4);
            opacity: 0; transition: opacity 0.5s ease;
            z-index: 1;
        }
        /* Im Light Mode weniger abdunkeln */
        body.light-mode .header-blur-bg { filter: blur(25px) brightness(1.2); }

        .logo { 
            font-size: 34px; font-weight: 800; letter-spacing: -1px; 
            position: relative; z-index: 2;
            transform-origin: left center;
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            color: var(--ios-text);
        }

        /* --- NEU: Header More Button --- */
        .header-more-btn {
            width: 34px; height: 34px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center;
            margin-left: auto; /* Push to right */
            cursor: pointer;
            z-index: 2000; /* Über Sticky Bar */
            color: var(--ios-blue);
            font-size: 16px;
            transition: background 0.2s, color 0.2s;
            border: 1px solid rgba(255,255,255,0.05);
        }
        body.light-mode .header-more-btn {
            background: rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.05);
        }
        .header-more-btn:active { opacity: 0.7; transform: scale(0.95); }


        .sticky-app-bar {
            position: absolute; left: 0; top: 0; width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; box-sizing: border-box;
            z-index: 3;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            pointer-events: none;
            padding-right: 60px; /* Platz für More Button lassen */
        }
        
        .sticky-left { display: flex; align-items: center; overflow: hidden; }
        .sticky-icon { width: 38px; height: 38px; border-radius: 8px; margin-right: 12px; background: #333; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .sticky-info-text { display: flex; flex-direction: column; overflow: hidden; }
        .sticky-name { font-weight: 600; font-size: 15px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 120px; color: var(--ios-text); }
        .sticky-sub { font-size: 11px; opacity: 0.7; color: var(--ios-text); }
        
        .sticky-btn {
            background: rgba(255,255,255,0.2); color: white;
            border: 1px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
            padding: 6px 16px; border-radius: 20px;
            font-weight: 700; font-size: 12px;
            cursor: pointer; transition: background 0.2s;
            white-space: nowrap;
        }
        body.light-mode .sticky-btn { color: #000; border: 1px solid rgba(0,0,0,0.1); background: rgba(255,255,255,0.8); }
        .sticky-btn:hover { background: rgba(255,255,255,0.3); }

        header.scrolled {
            height: var(--header-collapsed);
            background: rgba(0,0,0,0.3);
            border-bottom: var(--glass-border);
        }
        body.light-mode header.scrolled { background: rgba(255,255,255,0.6); }

        header.scrolled .header-blur-bg { opacity: 1; }
        header.scrolled .logo { opacity: 0; transform: translateY(-20px) scale(0.8); }
        header.scrolled .sticky-app-bar { 
            opacity: 1; transform: translateY(0); pointer-events: auto; 
        }

        /* --- CATEGORY PILLS --- */
        .category-scroll {
            display: flex;
            overflow-x: auto;
            padding: 10px 20px;
            gap: 10px;
            scrollbar-width: none;
            margin-bottom: 5px;
        }
        .category-scroll::-webkit-scrollbar { display: none; }
        
        .cat-pill {
            background: rgba(255,255,255,0.08);
            color: var(--ios-subtext);
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        body.light-mode .cat-pill { background: rgba(0,0,0,0.05); color: #666; }

        .cat-pill:hover { background: rgba(255,255,255,0.15); color: var(--ios-text); }
        body.light-mode .cat-pill:hover { background: rgba(0,0,0,0.1); }

        .cat-pill.active {
            background: var(--ios-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(10, 132, 255, 0.4);
        }

        /* --- SKELETON SCREENS --- */
        .skeleton-loader { padding: 20px; }
        .skeleton { background: #2C2C2E; border-radius: 8px; animation: pulse 1.5s infinite ease-in-out; }
        body.light-mode .skeleton { background: #E5E5EA; }
        .sk-hero { height: 420px; border-radius: var(--radius-l); margin-bottom: 30px; width: 100%; }
        .sk-row { display: flex; gap: 18px; overflow: hidden; margin-bottom: 30px; }
        .sk-card { width: 120px; height: 120px; border-radius: 26px; flex-shrink: 0; }
        .sk-list { margin-top: 20px; }
        .sk-item { display: flex; align-items: center; margin-bottom: 20px; }
        .sk-icon { width: 62px; height: 62px; border-radius: 14px; margin-right: 15px; }
        .sk-text-lines { flex: 1; }
        .sk-line { height: 10px; border-radius: 4px; margin-bottom: 8px; }
        .sk-line.short { width: 40%; }
        .sk-line.long { width: 70%; }

        /* FEATURED BANNER */
        .featured-banner {
            margin: 15px 20px 30px; background: #111; border-radius: var(--radius-l);
            height: 420px; position: relative; overflow: hidden; display: flex;
            flex-direction: column; justify-content: flex-end; border: var(--glass-border);
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        body.light-mode .featured-banner { box-shadow: 0 20px 40px rgba(0,0,0,0.15); }
        .featured-banner:hover { transform: scale(1.02); box-shadow: 0 30px 60px rgba(0,0,0,0.8); }
        body.light-mode .featured-banner:hover { box-shadow: 0 30px 60px rgba(0,0,0,0.2); }

        .featured-img-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover !important; background-position: center !important;
            filter: brightness(0.5); z-index: 1; transition: transform 5s ease;
        }
        .featured-banner:hover .featured-img-bg { transform: scale(1.1); }
        .featured-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.95) 100%);
            z-index: 2;
        }
        .featured-info { position: relative; z-index: 3; padding: 30px; text-align: center; display: flex; flex-direction: column; align-items: center; width: 100%; box-sizing: border-box; }
        .featured-tag { color: #bf55ec; font-size: 11px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; }
        .featured-title-wrap { width: 100%; overflow: hidden; white-space: nowrap; margin-bottom: 5px; }
        .featured-title { font-size: 28px; font-weight: 800; color: white !important; display: inline-block; }
        .featured-banner:hover .featured-title { animation: scrollText 4s linear infinite; }
        .featured-desc { font-size: 15px; color: #ccc; margin-bottom: 20px; }
        .get-btn { 
            background: #FFFFFF; color: #000; padding: 12px 50px; border-radius: 25px; 
            font-weight: 700; font-size: 16px; border: none; transition: transform 0.2s; cursor: pointer;
        }
        .get-btn:hover { transform: scale(1.05); background: #eee; }

        /* SECTIONS */
        .section-title { padding: 20px 20px 15px; font-size: 22px; font-weight: 700; display: flex; justify-content: space-between; align-items: center; color: var(--ios-text); }
        .section-more { color: var(--ios-blue); font-size: 16px; font-weight: 400; cursor: pointer; transition: opacity 0.2s; }
        .section-more:hover { opacity: 0.7; }
        .horizontal-scroll { display: flex; overflow-x: auto; padding: 0 20px 25px; gap: 18px; scrollbar-width: none; }
        .horizontal-scroll::-webkit-scrollbar { display: none; }

        /* CARDS & ITEMS */
        .card-item { width: 120px; min-width: 120px; cursor: pointer; transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); -webkit-touch-callout: none; }
        .card-item:hover { transform: translateY(-5px) scale(1.03); }
        .card-icon { width: 120px; height: 120px; border-radius: 26px; object-fit: cover; border: var(--glass-border); margin-bottom: 10px; background: #222; transition: filter 0.3s; pointer-events: none; }
        .card-item:hover .card-icon { filter: brightness(1.2); }
        .card-name-wrap { width: 100%; overflow: hidden; white-space: nowrap; margin-bottom: 2px; mask-image: linear-gradient(to right, black 90%, transparent 100%); pointer-events: none; }
        .card-name { font-size: 14px; font-weight: 500; color: var(--ios-text) !important; display: inline-block; text-overflow: ellipsis; }
        .card-item:hover .card-name { text-overflow: clip; animation: scrollText 3s linear infinite; padding-right: 20px; }
        .card-author { font-size: 12px; color: var(--ios-subtext); pointer-events: none; }

        .app-list-container { background: var(--ios-card); margin: 0 20px; border-radius: var(--radius-m); padding: 0 16px; border: var(--glass-border); transition: background 0.3s; }
        .app-item { display: flex; padding: 15px 0; border-bottom: 0.5px solid var(--ios-separator); align-items: center; cursor: pointer; transition: background 0.2s, transform 0.2s; -webkit-touch-callout: none; }
        .app-item:last-child { border-bottom: none; }
        .app-item:hover { background: rgba(125,125,125,0.05); transform: scale(1.01); }
        .app-icon { width: 62px; height: 62px; border-radius: 14px; margin-right: 15px; border: var(--glass-border); background: #222; object-fit: cover; pointer-events: none; }
        .app-info { flex-grow: 1; min-width: 0; overflow: hidden; pointer-events: none; }
        .app-name-wrap { width: 100%; overflow: hidden; white-space: nowrap; margin-bottom: 3px; mask-image: linear-gradient(to right, black 90%, transparent 100%); }
        .app-name { font-weight: 600; font-size: 17px; color: var(--ios-text) !important; display: inline-block; text-overflow: ellipsis; }
        .app-item:hover .app-name { text-overflow: clip; animation: scrollText 4s linear infinite; padding-right: 30px; }
        .app-meta { font-size: 13px; color: var(--ios-subtext); }
        .laden-badge { background: #333; color: var(--ios-blue); padding: 6px 18px; border-radius: 20px; font-weight: 800; font-size: 12px; transition: background 0.2s; pointer-events: none; }
        body.light-mode .laden-badge { background: #F2F2F7; }
        .app-item:hover .laden-badge { background: #444; color: #fff; }

        /* LOAD MORE BUTTON */
        .load-more-btn {
            background: var(--ios-card); color: var(--ios-blue);
            border: var(--glass-border); padding: 12px 35px;
            border-radius: 30px; font-weight: 600; font-size: 15px;
            cursor: pointer; transition: all 0.3s ease; margin: 20px auto;
            display: inline-block; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .load-more-btn:hover { background: rgba(125,125,125,0.1); transform: scale(1.05); }
        #load-more-container { transition: opacity 0.5s ease; text-align: center; }

        /* ERROR & SEARCH */
        .error-msg { text-align: center; padding: 50px 20px; color: var(--ios-subtext); font-size: 16px; font-weight: 500; }
        .error-icon { font-size: 40px; margin-bottom: 15px; opacity: 0.5; display: block; }

        /* SEARCH BAR */
        .search-bar {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(10, 10, 10, 0.7); 
            backdrop-filter: blur(40px) saturate(180%);
            z-index: 5000; 
            opacity: 0; pointer-events: none;
            transition: opacity 0.3s ease, backdrop-filter 0.3s ease;
            padding-top: 60px;
        }
        body.light-mode .search-bar { background: rgba(255, 255, 255, 0.6); }

        .search-bar.active { opacity: 1; pointer-events: auto; }
        
        .search-box { 
            display: flex; align-items: center; padding: 0 20px; gap: 15px; 
            transform: translateY(-10px); transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .search-bar.active .search-box { transform: translateY(0); }

        .input-wrap { 
            flex: 1; 
            background: rgba(255, 255, 255, 0.12);
            border-radius: 12px; 
            display: flex; align-items: center; padding: 12px 15px; 
            border: 1px solid rgba(255,255,255,0.05);
            transition: background 0.2s;
        }
        body.light-mode .input-wrap { background: rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.05); }

        .input-wrap:focus-within { background: rgba(255, 255, 255, 0.18); }
        body.light-mode .input-wrap:focus-within { background: rgba(0,0,0,0.1); }
        
        .input-wrap input { background: transparent; border: none; color: white; font-size: 17px; width: 100%; outline: none; margin-left: 10px; font-weight: 500; }
        body.light-mode .input-wrap input { color: #000; }
        .input-wrap input::placeholder { color: rgba(255,255,255,0.4); }
        body.light-mode .input-wrap input::placeholder { color: rgba(0,0,0,0.4); }

        /* SEARCH HISTORY */
        .search-history-container { padding: 0 20px; margin-top: 20px; }
        .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; color: var(--ios-text); }
        .history-title { font-size: 18px; font-weight: 700; }
        .history-clear { font-size: 14px; color: var(--ios-blue); cursor: pointer; }
        .history-item { 
            display: flex; align-items: center; padding: 12px 0; 
            border-bottom: 0.5px solid var(--ios-separator); cursor: pointer; 
        }
        .history-item i { margin-right: 15px; color: var(--ios-subtext); font-size: 14px; }
        .history-text { font-size: 16px; color: var(--ios-blue); }

        /* NAV */
        .bottom-nav {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 240px; height: 74px; 
            background: var(--nav-bg); 
            backdrop-filter: blur(50px) saturate(160%);
            -webkit-backdrop-filter: blur(50px) saturate(160%);
            border-radius: 37px;
            display: flex; justify-content: space-evenly; align-items: center;
            z-index: 4000; 
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        body.light-mode .bottom-nav { border: 1px solid rgba(0,0,0,0.1); box-shadow: 0 20px 40px rgba(0,0,0,0.15); }
        .bottom-nav.nav-scrolled { width: 140px; height: 52px; bottom: 20px; }
        .animate-nav { animation: fadeInUp 0.8s 0.6s backwards; }
        .nav-item { color: var(--nav-item); text-align: center; cursor: pointer; transition: color 0.3s, transform 0.2s; }
        .nav-item.active { color: var(--nav-active); text-shadow: 0 0 15px rgba(255,255,255,0.3); }
        body.light-mode .nav-item.active { text-shadow: none; }
        .nav-item.active i { animation: popBounce 0.4s ease forwards; color: var(--ios-blue); }
        .nav-item:hover { transform: scale(1.1); color: var(--nav-active); }
        .nav-item i { font-size: 24px; display: block; margin-bottom: 4px; transition: margin 0.3s ease; }
        .nav-item span { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; display: block; opacity: 1; height: auto; transition: opacity 0.3s ease, height 0.3s ease, margin 0.3s ease; }
        .bottom-nav.nav-scrolled .nav-item span { opacity: 0; height: 0; margin: 0; overflow: hidden; }
        .bottom-nav.nav-scrolled .nav-item i { margin-bottom: 0; }

        /* --- IOS 26 / APPLE STYLE CONTEXT MENU --- */
        .context-menu-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.0); /* Start transparent */
            backdrop-filter: blur(0px);
            -webkit-backdrop-filter: blur(0px);
            z-index: 6000;
            display: none; 
            opacity: 0; 
            transition: background 0.3s, opacity 0.3s, backdrop-filter 0.3s;
        }
        
        .context-menu-overlay.active {
            display: block;
            opacity: 1;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
        }
        body.light-mode .context-menu-overlay.active { background: rgba(255,255,255,0.3); }

        /* The Cloned Element (Floating) */
        .ios-clone-element {
            position: fixed;
            z-index: 6005;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-origin: center center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        body.light-mode .ios-clone-element { box-shadow: 0 20px 50px rgba(0,0,0,0.2); }
        
        .ios-clone-element.active {
            transform: scale(1.05);
        }

        /* The Menu List */
        .ios-menu-wrapper {
            position: absolute;
            width: 250px;
            background: rgba(30,30,30,0.85);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border-radius: 14px;
            overflow: hidden;
            display: flex; flex-direction: column;
            z-index: 6006;
            transform-origin: top center;
            animation: iosMenuSpring 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }
        body.light-mode .ios-menu-wrapper { background: rgba(250,250,250,0.9); box-shadow: 0 15px 40px rgba(0,0,0,0.15); }

        .menu-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 14px 16px;
            cursor: pointer;
            transition: background 0.2s;
            color: var(--ios-text);
            font-size: 16px;
            font-weight: 500;
        }
        .menu-item:active { background: rgba(255,255,255,0.15); }
        body.light-mode .menu-item:active { background: rgba(0,0,0,0.1); }
        
        .menu-item i { font-size: 18px; width: 25px; text-align: center; }
        .menu-item .menu-text { flex: 1; margin-left: 10px; }
        
        .menu-separator { height: 1px; background: var(--ios-separator); width: 100%; }

        .menu-danger { color: #ff453a; }

        /* SETTINGS OVERLAY SPECIFIC */
        #settings-menu-overlay .context-menu-wrapper {
            position: absolute; bottom: 120px; right: 20px;
            width: auto;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

<div id="context-menu-overlay" class="context-menu-overlay" onclick="closeContextMenu()"></div>

<div id="settings-menu-overlay" class="context-menu-overlay" onclick="toggleSettings(false)">
    <div class="ios-menu-wrapper" style="position: absolute; bottom: 120px; right: 20px; width: 260px;" onclick="event.stopPropagation()">
        <div class="menu-item" onclick="toggleTheme()">
            <span class="menu-text" id="theme-text">Zu Light Mode wechseln</span>
            <i id="theme-icon" class="fas fa-sun"></i>
        </div>
        <div class="menu-separator"></div>
        <div class="menu-item" onclick="location.reload()">
            <span class="menu-text">Seite neu laden</span>
            <i class="fas fa-rotate-right"></i>
        </div>
    </div>
</div>

<div class="search-bar" id="search-overlay">
    <div class="search-box">
        <div class="input-wrap">
            <i class="fas fa-search" style="color:var(--ios-subtext)"></i>
            <input type="text" id="search-input" placeholder="Apps, Spiele und Tools..." autocomplete="off">
        </div>
        <span onclick="toggleSearch(false)" style="color:var(--ios-blue); font-size:17px; cursor:pointer; font-weight:500;">Abbrechen</span>
    </div>
    
    <div id="search-history" class="search-history-container" style="display:none;">
        <div class="history-header">
            <span class="history-title">Letzte Suchen</span>
            <span class="history-clear" onclick="clearHistory()">Löschen</span>
        </div>
        <div id="history-list"></div>
    </div>

    <div id="search-results" class="app-list-container animate-entry" style="margin-top:25px; max-height: 75vh; overflow-y: auto; background: transparent; border: none; padding: 0;"></div>
</div>

<header id="main-header" class="animate-entry">
    <div class="header-blur-bg" id="header-blur"></div>
    <div class="logo">DownAPK</div>
    
    <div class="sticky-app-bar" id="sticky-bar" onclick="window.location.href='#'">
        <div class="sticky-left">
            <img id="sticky-icon" src="" class="sticky-icon" onerror="this.style.background='#333'">
            <div class="sticky-info-text">
                <span id="sticky-name" class="sticky-name">Laden...</span>
                <span class="sticky-sub">Empfehlung</span>
            </div>
        </div>
        <button class="sticky-btn">LADEN</button>
    </div>

    <div class="header-more-btn" onclick="toggleSettings(true)">
        <i class="fas fa-ellipsis"></i>
    </div>
</header>

<div class="header-spacer"></div>

<div id="skeleton-loader" class="skeleton-loader">
    <div class="skeleton sk-hero"></div>
    <div class="sk-row">
        <div class="skeleton sk-card"></div>
        <div class="skeleton sk-card"></div>
        <div class="skeleton sk-card"></div>
        <div class="skeleton sk-card"></div>
    </div>
    <div class="skeleton sk-list-item" style="height: 30px; width: 150px; margin-bottom: 20px;"></div>
    <div class="sk-list">
        <div class="sk-item">
            <div class="skeleton sk-icon"></div>
            <div class="sk-text-lines">
                <div class="skeleton sk-line long"></div>
                <div class="skeleton sk-line short"></div>
            </div>
        </div>
        <div class="sk-item">
            <div class="skeleton sk-icon"></div>
            <div class="sk-text-lines">
                <div class="skeleton sk-line long"></div>
                <div class="skeleton sk-line short"></div>
            </div>
        </div>
    </div>
</div>

<div id="content-main" style="display: none;">
    
    <div class="category-scroll animate-entry">
        <div class="cat-pill active" onclick="selectCat(this, 'Alle')">Alle</div>
        <div class="cat-pill" onclick="selectCat(this, 'Spiele')">Spiele</div>
        <div class="cat-pill" onclick="selectCat(this, 'Tools')">Tools</div>
        <div class="cat-pill" onclick="selectCat(this, 'Social Media')">Social Media</div>
        <div class="cat-pill" onclick="selectCat(this, 'Privacy')">Privacy</div>
        <div class="cat-pill" onclick="selectCat(this, 'Media')">Media</div>
        <div class="cat-pill" onclick="selectCat(this, 'Produktivität')">Produktivität</div>
        <div class="cat-pill" onclick="selectCat(this, 'Lifestyle')">Lifestyle</div>
        <div class="cat-pill" onclick="selectCat(this, 'Bildung')">Bildung</div>
        <div class="cat-pill" onclick="selectCat(this, 'Finanzen')">Finanzen</div>
    </div>

    <div id="featured-hero" class="animate-entry delay-1"></div>

    <div class="section-title animate-entry delay-2">Angesagt <i class="fas fa-chevron-right" onclick="viewAll('Angesagt')" style="font-size:14px; opacity:0.3; cursor:pointer;"></i></div>
    <div class="horizontal-scroll animate-entry delay-2" id="scroll-trending"></div>

    <div class="section-title animate-entry delay-3">Top Apps <span class="section-more" onclick="viewAll('Top Apps')">Alle</span></div>
    <div class="horizontal-scroll animate-entry delay-3" id="scroll-top"></div>

    <div class="section-title animate-entry delay-4">Neueste Updates</div>
    <div id="update-feed" class="app-list-container animate-entry delay-4"></div>
    
    <div id="load-more-container" class="animate-entry delay-4">
        <button class="load-more-btn" onclick="loadMore()">Mehr laden</button>
    </div>
</div>

<nav class="bottom-nav animate-nav">
    <div class="nav-item active" id="btn-home" onclick="toggleSearch(false)">
        <i class="fas fa-house"></i>
        <span>Home</span>
    </div>
    <div class="nav-item" id="btn-search" onclick="toggleSearch(true)">
        <i class="fas fa-magnifying-glass"></i>
        <span>Suche</span>
    </div>
</nav>

<script>
    // --- THEME LOGIC START ---
    let isLightMode = false;

    function toggleSettings(show) {
        const overlay = document.getElementById('settings-menu-overlay');
        if(show) {
            overlay.classList.add('active');
        } else {
            overlay.classList.remove('active');
        }
    }

    function toggleTheme() {
        isLightMode = !isLightMode;
        
        // CSS Klasse am Body umschalten
        if (isLightMode) {
            document.body.classList.add('light-mode');
            document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]').setAttribute("content", "default");
        } else {
            document.body.classList.remove('light-mode');
            document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]').setAttribute("content", "black-translucent");
        }

        // Text und Icon im Menü anpassen
        const text = document.getElementById('theme-text');
        const icon = document.getElementById('theme-icon');
        
        if (isLightMode) {
            text.innerText = "Zu Dark Mode wechseln";
            icon.className = "fas fa-moon";
        } else {
            text.innerText = "Zu Light Mode wechseln";
            icon.className = "fas fa-sun";
        }

        // Menü schließen
        toggleSettings(false);
    }
    // --- THEME LOGIC END ---

    // Kategorien hinzugefügt für Filter-Logik
    let appDatabase = [
        { name: "PhotoSwooper", author: "krille-chan", pkg: "com.github.krille_chan.photoswooper", icon: "https://f-droid.org/repo/com.github.krille_chan.photoswooper/en-US/icon.png", ver: "2.1.0", cat: "Tools" },
        { name: "OmWeather", author: "woheller69", pkg: "org.woheller69.omweather", icon: "https://f-droid.org/repo/org.woheller69.omweather/en-US/icon.png", ver: "1.5.2", cat: "Tools" },
        { name: "NewPipe", author: "Team NewPipe", pkg: "org.schabi.newpipe", icon: "https://f-droid.org/repo/org.schabi.newpipe/en-US/icon.png", ver: "0.27.0", cat: "Media" },
        { name: "Telegram FOSS", author: "Telegram", pkg: "org.telegram.messenger", icon: "https://f-droid.org/repo/org.telegram.messenger/en-US/icon.png", ver: "10.3.1", cat: "Social Media" },
        { name: "AdAway", author: "AdAway", pkg: "org.adaway", icon: "https://f-droid.org/repo/org.adaway/en-US/icon.png", ver: "6.1.1", cat: "Privacy" },
        { name: "F-Droid", author: "F-Droid", pkg: "org.fdroid.fdroid", icon: "https://f-droid.org/repo/org.fdroid.fdroid/en-US/icon.png", ver: "1.19", cat: "Tools" },
        { name: "AntennaPod", author: "AntennaPod", pkg: "de.danoeh.antennapod", icon: "https://f-droid.org/repo/de.danoeh.antennapod/en-US/icon.png", ver: "3.2.0", cat: "Media" },
        { name: "VLC", author: "VideoLAN", pkg: "org.videolan.vlc", icon: "https://f-droid.org/repo/org.videolan.vlc/en-US/icon.png", ver: "3.5.4", cat: "Media" },
        { name: "SuperTuxKart", author: "Tux", pkg: "org.supertuxkart", icon: "https://f-droid.org/repo/org.supertuxkart.stk/en-US/icon.png", ver: "1.4", cat: "Spiele" } 
    ];

    let currentFeedApps = [];
    let currentFeedCount = 0;
    const feedBatchSize = 4; // Lade 4 Apps auf einmal für den Showcase

    async function loadFDroidApps() {
        // Kurzer Delay für Skeleton-Demo
        await new Promise(r => setTimeout(r, 600));

        try {
            const response = await fetch('/api/apps');
            const data = await response.json();
            const remoteApps = data.map(app => ({
                name: app.name,
                author: app.author,
                pkg: app.packageName,
                icon: app.icon,
                ver: app.version,
                cat: "Tools" // Default cat für API items
            }));
            appDatabase = [...appDatabase, ...remoteApps];
        } catch (e) { console.log("Verwende Offline DB"); } 
        finally { render('Alle'); }
    }

    function shuffle(array) { return array.sort(() => Math.random() - 0.5); }

    // --- SEARCH LOGIC ---
    let searchHistory = JSON.parse(localStorage.getItem('downApkHistory')) || [];

    function addToHistory(term) {
        if(!term) return;
        searchHistory = searchHistory.filter(item => item !== term); // Remove duplicate
        searchHistory.unshift(term);
        if(searchHistory.length > 5) searchHistory.pop();
        localStorage.setItem('downApkHistory', JSON.stringify(searchHistory));
    }

    function clearHistory() {
        searchHistory = [];
        localStorage.removeItem('downApkHistory');
        renderHistory();
    }

    function renderHistory() {
        const list = document.getElementById('history-list');
        const container = document.getElementById('search-history');
        const input = document.getElementById('search-input');
        
        if (input.value !== "") {
            container.style.display = 'none';
            return;
        }

        if (searchHistory.length === 0) {
            container.style.display = 'none';
        } else {
            container.style.display = 'block';
            list.innerHTML = "";
            searchHistory.forEach(term => {
                list.innerHTML += `
                    <div class="history-item" onclick="performSearch('${term}'); document.getElementById('search-input').value = '${term}'">
                        <i class="fas fa-clock"></i>
                        <span class="history-text">${term}</span>
                    </div>
                `;
            });
        }
    }

    function toggleSearch(show) {
        const overlay = document.getElementById('search-overlay');
        const btnSearch = document.getElementById('btn-search');
        const btnHome = document.getElementById('btn-home');
        
        if(show) {
            overlay.classList.add('active');
            btnSearch.classList.add('active');
            btnHome.classList.remove('active');
            renderHistory();
            setTimeout(() => document.getElementById('search-input').focus(), 100);
        } else {
            overlay.classList.remove('active');
            btnSearch.classList.remove('active');
            btnHome.classList.add('active');
            document.getElementById('search-input').blur();
        }
    }

    function viewAll(title) {
        toggleSearch(true);
        document.getElementById('search-input').value = ""; 
        renderHistory();
    }

    // Filter-Funktion für Kategorien
    function selectCat(el, category) {
        document.querySelectorAll('.cat-pill').forEach(p => p.classList.remove('active'));
        el.classList.add('active');
        render(category);
    }

    // --- NEW IOS CONTEXT MENU LOGIC START ---
    let pressTimer;
    let selectedApp = {};
    let activeClone = null; // Track the cloned element

    function startLongPress(e, name, author, icon, pkg) {
        // We need to capture the exact element that was touched to clone it positionally
        const targetElement = e.currentTarget;
        
        selectedApp = { name, author, icon, pkg };
        pressTimer = setTimeout(() => {
            openContextMenu(targetElement);
        }, 500); 
    }

    function cancelLongPress() {
        clearTimeout(pressTimer);
    }

    function handleContext(e, name, author, icon, pkg) {
        e.preventDefault();
        // For desktop right click, we use currentTarget
        const targetElement = e.currentTarget;
        selectedApp = { name, author, icon, pkg };
        openContextMenu(targetElement);
        return false;
    }

    function openContextMenu(element) {
        if(navigator.vibrate) navigator.vibrate(50); 
        const overlay = document.getElementById('context-menu-overlay');
        overlay.innerHTML = ''; // Clear previous

        // 1. Get position of the clicked element
        const rect = element.getBoundingClientRect();
        
        // 2. Clone the element
        const clone = element.cloneNode(true);
        clone.classList.remove('animate-entry'); // Remove entry animation to prevent flickering
        clone.classList.add('ios-clone-element');
        
        // 3. Position the clone exactly where the original is
        clone.style.top = rect.top + 'px';
        clone.style.left = rect.left + 'px';
        clone.style.width = rect.width + 'px';
        clone.style.height = rect.height + 'px';
        clone.style.margin = '0'; // Reset margins
        
        // Append clone to overlay
        overlay.appendChild(clone);
        activeClone = clone;

        // 4. Construct the Menu Items
        const menuHTML = `
            <div class="ios-menu-wrapper" id="ios-menu-list">
                <div class="menu-item" onclick="window.location.href='app.html?id=${selectedApp.pkg}'">
                    <span class="menu-text">Öffnen</span>
                    <i class="fas fa-arrow-up-right-from-square"></i>
                </div>
                <div class="menu-separator"></div>
                <div class="menu-item" onclick="shareApp('${selectedApp.name}')">
                    <span class="menu-text">Teilen</span>
                    <i class="fas fa-share-nodes"></i>
                </div>
                <div class="menu-separator"></div>
                <div class="menu-item">
                    <span class="menu-text">Zur Merkliste</span>
                    <i class="fas fa-bookmark"></i>
                </div>
                <div class="menu-separator"></div>
                <div class="menu-item menu-danger">
                    <span class="menu-text">Entfernen</span>
                    <i class="fas fa-trash"></i>
                </div>
            </div>
        `;
        overlay.insertAdjacentHTML('beforeend', menuHTML);

        // 5. Position the Menu Smartly
        const menu = document.getElementById('ios-menu-list');
        const windowHeight = window.innerHeight;
        const menuHeight = 220; // Approx height

        // Center horizontally relative to item, but constrained to screen
        let menuLeft = rect.left + (rect.width / 2) - 125; // 125 is half menu width
        if(menuLeft < 10) menuLeft = 10;
        if(menuLeft + 250 > window.innerWidth) menuLeft = window.innerWidth - 260;

        // Determine Vertical Position (Above or Below)
        let menuTop;
        const spaceBelow = windowHeight - rect.bottom;
        
        if (spaceBelow > menuHeight + 20) {
            // Place below
            menuTop = rect.bottom + 15;
            menu.style.transformOrigin = 'top center';
        } else {
            // Place above
            menuTop = rect.top - menuHeight - 15;
            menu.style.transformOrigin = 'bottom center';
        }

        menu.style.top = menuTop + 'px';
        menu.style.left = menuLeft + 'px';

        // 6. Activate Overlay & Animation
        overlay.classList.add('active');
        
        // Slight delay to allow DOM render before transforming clone
        requestAnimationFrame(() => {
            clone.classList.add('active'); // Scales up 1.05x
        });
    }

    function closeContextMenu() {
        const overlay = document.getElementById('context-menu-overlay');
        overlay.classList.remove('active');
        
        if(activeClone) {
            activeClone.style.transform = 'scale(1)'; // Scale back down
        }

        setTimeout(() => {
            overlay.innerHTML = ''; // Cleanup
            activeClone = null;
        }, 300);
    }
    
    function shareApp(name) {
        if (navigator.share) {
            navigator.share({
                title: 'DownAPK',
                text: 'Schau dir ' + name + ' auf DownAPK an!',
                url: window.location.href
            });
        }
        closeContextMenu();
    }
    // --- CONTEXT MENU LOGIC END ---

    function renderError() {
        document.getElementById('skeleton-loader').style.display = 'none';
        document.getElementById('content-main').style.display = 'block';
        const errorHTML = `<div class="error-msg"><i class="fas fa-wifi error-icon"></i>Keine Apps gefunden.</div>`;
        document.getElementById('scroll-trending').innerHTML = errorHTML;
    }

    // Erstellt das HTML für ein App-Item der Update-Liste
    function getAppItemHTML(app) {
        // Pass event.currentTarget implicitly by handling it in startLongPress via event
        return `
            <div class="app-item animate-entry" 
                 onclick="if(!document.getElementById('context-menu-overlay').classList.contains('active')) window.location.href='app.html?id=${app.pkg}'"
                 ontouchstart="startLongPress(event, '${app.name}', '${app.author}', '${app.icon}', '${app.pkg}')"
                 ontouchend="cancelLongPress()"
                 ontouchmove="cancelLongPress()"
                 oncontextmenu="return handleContext(event, '${app.name}', '${app.author}', '${app.icon}', '${app.pkg}')">
                <img src="${app.icon}" class="app-icon" onerror="this.src='https://f-droid.org/repo/${app.pkg}/en-US/icon.png'">
                <div class="app-info">
                    <div class="app-name-wrap"><span class="app-name">${app.name}</span></div>
                    <div class="app-meta">${app.cat} • v${app.ver}</div>
                </div>
                <div class="laden-badge">LADEN</div>
            </div>
        `;
    }

    // Läd mehr Apps, wenn auf den Button geklickt wird
    function loadMore() {
        const feed = document.getElementById('update-feed');
        const nextCount = Math.min(currentFeedCount + feedBatchSize, currentFeedApps.length);
        
        currentFeedApps.slice(currentFeedCount, nextCount).forEach(app => {
            feed.innerHTML += getAppItemHTML(app);
        });
        
        currentFeedCount = nextCount;
        
        if (currentFeedCount >= currentFeedApps.length) {
            const container = document.getElementById('load-more-container');
            container.style.opacity = '0';
            setTimeout(() => { container.style.display = 'none'; }, 500);
        }
    }

    // Render akzeptiert jetzt Filter
    function render(filterCat) {
        document.getElementById('skeleton-loader').style.display = 'none';
        document.getElementById('content-main').style.display = 'block';

        if (!appDatabase || appDatabase.length === 0) { renderError(); return; }

        // Filtern
        let filteredApps = appDatabase;
        if (filterCat && filterCat !== 'Alle') {
            filteredApps = appDatabase.filter(app => app.cat === filterCat);
        }

        if(filteredApps.length === 0) {
             document.getElementById('scroll-trending').innerHTML = `<div style="padding:20px; color:#666;">Keine Apps in "${filterCat}"</div>`;
             document.getElementById('scroll-top').innerHTML = "";
             document.getElementById('update-feed').innerHTML = "";
             document.getElementById('load-more-container').style.display = 'none';
             return;
        }

        const shuffled = shuffle([...filteredApps]);
        const feat = shuffled[0];

        // Header Update
        document.getElementById('header-blur').style.backgroundImage = `url('${feat.icon}')`;
        document.getElementById('sticky-icon').src = feat.icon;
        document.getElementById('sticky-name').innerText = feat.name;
        document.getElementById('sticky-bar').onclick = () => window.location.href = `app.html?id=${feat.pkg}`;

        document.getElementById('featured-hero').innerHTML = `
            <div class="featured-banner" onclick="window.location.href='app.html?id=${feat.pkg}'">
                <div class="featured-img-bg" style="background: url('${feat.icon}') center/cover"></div>
                <div class="featured-overlay"></div>
                <div class="featured-info">
                    <span class="featured-tag">Highlights</span>
                    <div class="featured-title-wrap"><span class="featured-title">${feat.name}</span></div>
                    <div class="featured-desc">Von ${feat.author} • ${feat.cat || 'App'}</div>
                    <button class="get-btn">Laden</button>
                </div>
            </div>
        `;

        const trending = document.getElementById('scroll-trending');
        const top = document.getElementById('scroll-top');
        const feed = document.getElementById('update-feed');
        trending.innerHTML = ""; top.innerHTML = ""; feed.innerHTML = "";
        
        // Updated Card with Touch/Context Listeners
        const createCard = (app) => `
            <div class="card-item animate-entry" 
                 onclick="if(!document.getElementById('context-menu-overlay').classList.contains('active')) window.location.href='app.html?id=${app.pkg}'"
                 ontouchstart="startLongPress(event, '${app.name}', '${app.author}', '${app.icon}', '${app.pkg}')"
                 ontouchend="cancelLongPress()"
                 ontouchmove="cancelLongPress()"
                 oncontextmenu="return handleContext(event, '${app.name}', '${app.author}', '${app.icon}', '${app.pkg}')">
                <img src="${app.icon}" class="card-icon" onerror="this.src='https://f-droid.org/repo/${app.pkg}/en-US/icon.png'">
                <div class="card-name-wrap"><span class="card-name">${app.name}</span></div>
                <span class="card-author">${app.author}</span>
            </div>
        `;

        shuffled.slice(0, 8).forEach(app => trending.innerHTML += createCard(app));
        [...shuffled].reverse().slice(0, 8).forEach(app => top.innerHTML += createCard(app));
        
        // --- NEUE LADE-LOGIK FÜR DEN FEED ---
        currentFeedApps = shuffled;
        currentFeedCount = Math.min(feedBatchSize, currentFeedApps.length);
        
        currentFeedApps.slice(0, currentFeedCount).forEach(app => {
            feed.innerHTML += getAppItemHTML(app);
        });

        const loadMoreContainer = document.getElementById('load-more-container');
        if (currentFeedApps.length > currentFeedCount) {
            loadMoreContainer.style.display = 'block';
            setTimeout(() => { loadMoreContainer.style.opacity = '1'; }, 50);
        } else {
            loadMoreContainer.style.display = 'none';
        }
    }

    function performSearch(query) {
        const resultsBox = document.getElementById('search-results');
        const historyBox = document.getElementById('search-history');
        
        if (query === "") {
            renderHistory();
            resultsBox.innerHTML = "";
            return;
        }

        historyBox.style.display = 'none';
        resultsBox.innerHTML = "";
        const filtered = appDatabase.filter(a => a.name.toLowerCase().includes(query.toLowerCase()) || a.pkg.toLowerCase().includes(query.toLowerCase())).slice(0, 50);
        
        if(filtered.length === 0) {
            resultsBox.innerHTML = "<div style='padding:40px; color:#888; text-align:center;'>Keine Treffer.</div>";
        } else {
            filtered.forEach(app => {
                resultsBox.innerHTML += `
                    <div class="app-item" style="padding: 10px 16px; background: rgba(255,255,255,0.05); margin-bottom: 1px;" 
                         onclick="addToHistory('${app.name}'); window.location.href='app.html?id=${app.pkg}'">
                        <img src="${app.icon}" class="app-icon" style="width:48px; height:48px;" onerror="this.src='https://f-droid.org/repo/${app.pkg}/en-US/icon.png'">
                        <div class="app-info">
                            <div class="app-name-wrap"><span class="app-name" style="font-size:16px;">${app.name}</span></div>
                            <div class="app-meta">${app.cat}</div>
                        </div>
                        <i class="fas fa-chevron-right" style="opacity:0.3; font-size:12px;"></i>
                    </div>`;
            });
        }
    }

    // SCROLL LOGIK ERWEITERT
    let lastScrollTop = 0;
    const bottomNav = document.querySelector('.bottom-nav');

    window.addEventListener('scroll', () => {
        // Header Logik
        const header = document.getElementById('main-header');
        if (window.scrollY > 40) header.classList.add('scrolled');
        else header.classList.remove('scrolled');

        // NAV BAR LOGIK
        let st = window.scrollY || document.documentElement.scrollTop;
        if (st > lastScrollTop && st > 50) {
            bottomNav.classList.add('nav-scrolled');
        } else if (st < lastScrollTop) {
            bottomNav.classList.remove('nav-scrolled');
        }
        lastScrollTop = st <= 0 ? 0 : st;
    });

    document.getElementById('search-input').addEventListener('input', (e) => performSearch(e.target.value));
    window.onload = () => { loadFDroidApps(); };
</script>

<div style="text-align: center; margin-top: 20px; padding: 10px;">
    <p style="color: #888888; font-size: 12px; margin: 0;">Version 28.80</p>
    <p style="color: #666666; font-size: 10px; margin-top: 5px; opacity: 0.7;">By Nexus with ❤️</p>
    <div style="width: 100%; text-align: center; margin-top: 15px;">
        <a href="https://nexus-ashy.vercel.app/" style="color: #00ff00; text-decoration: none; font-size: 12px; font-weight: bold;">Mehr von uns</a>
    </div>
</div>
</body>
</html>
